# Cấu hình Render Blueprint cho dự án FastFood Django
# Sử dụng Docker để build và deploy backend
# LƯU Ý: 
# - PostgreSQL Database cần tạo THỦ CÔNG trước
# - Migration sẽ chạy tự động trong start.sh script

services:
  # Dịch vụ Web Django/DRF sử dụng Docker
  - type: web
    name: fastfood-backend
    env: docker
    plan: free 
    
    # Sử dụng Dockerfile ở root directory
    dockerfilePath: ./Dockerfile
    dockerContext: .
    
    # Health check endpoint (nếu có)
    healthCheckPath: /api/health/
    
    envVars:
      # DATABASE_URL - Cần thêm MANUAL sau khi tạo PostgreSQL database
      # Vào service này → Environment → Thêm DATABASE_URL = Internal Database URL từ PostgreSQL service
      - key: SECRET_KEY
        generateValue: true
      - key: ENVIRONMENT
        value: Production
      - key: DJANGO_SETTINGS_MODULE
        value: core.settings.prod
      # URL của Render Service
      - key: RENDER_EXTERNAL_HOSTNAME
        fromService:
          type: web
          name: fastfood-backend
          property: host
      # CORS - Thêm domain Vercel sau khi deploy frontend
      # Vào Environment → Thêm: CORS_ORIGINS=https://your-vercel-app.vercel.app
      # CELERY BROKER URL (Nếu bạn dùng Celery, hãy thêm URL Redis tại đây)
      - key: CELERY_BROKER_URL
        value: ""
